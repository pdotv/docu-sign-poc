const fs = require('fs');
const docusign = require('docusign-esign');

const makeEnvelope = () => {
  // Data for this method
  // args.signerEmail
  // args.signerName
  // args.signerClientId
  // docFile
  // document 1 (pdf) has tag /sn1/
  //
  // The envelope has one recipients.
  // recipient 1 - signer
  let docPdfBytes;
  // read file from a local directory
  // The read could raise an exception if the file is not available!
  docPdfBytes = fs.readFileSync('./signFile.pdf');

  // create the envelope definition
  let env = new docusign.EnvelopeDefinition();
  env.emailSubject = 'Please sign this document';

  // add the documents
  let doc1 = new docusign.Document(),
    doc1b64 = Buffer.from(docPdfBytes).toString('base64');
  doc1.documentBase64 =
    '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ago8PC9UeXBlL0ZvbnQvU3VidHlwZS9UcnVlVHlwZS9CYXNlRm9udC9CQUFBQUErTGliZXJhdGlvblNlcmlmLUl0YWxpYwovRmlyc3RDaGFyIDAKL0xhc3RDaGFyIDMKL1dpZHRoc1s3NzcgMzg5IDUwMCA1MDAgXQovRm9udERlc2NyaXB0b3IgNyAwIFIKL1RvVW5pY29kZSA4IDAgUgo+PgplbmRvYmoKCjEwIDAgb2JqCjw8L0YxIDkgMCBSCj4+CmVuZG9iagoKMTEgMCBvYmoKPDwvRm9udCAxMCAwIFIKL1Byb2NTZXRbL1BERi9UZXh0XQo+PgplbmRvYmoKCjEgMCBvYmoKPDwvVHlwZS9QYWdlL1BhcmVudCA0IDAgUi9SZXNvdXJjZXMgMTEgMCBSL01lZGlhQm94WzAgMCA1OTUuMzAzOTM3MDA3ODc0IDg0MS44ODk3NjM3Nzk1MjhdL0dyb3VwPDwvUy9UcmFuc3BhcmVuY3kvQ1MvRGV2aWNlUkdCL0kgdHJ1ZT4+L0NvbnRlbnRzIDIgMCBSPj4KZW5kb2JqCgo0IDAgb2JqCjw8L1R5cGUvUGFnZXMKL1Jlc291cmNlcyAxMSAwIFIKL01lZGlhQm94WyAwIDAgNTk1LjMwMzkzNzAwNzg3NCA4NDEuODg5NzYzNzc5NTI4IF0KL0tpZHNbIDEgMCBSIF0KL0NvdW50IDE+PgplbmRvYmoKCjEyIDAgb2JqCjw8L1R5cGUvQ2F0YWxvZy9QYWdlcyA0IDAgUgovT3BlbkFjdGlvblsxIDAgUiAvWFlaIG51bGwgbnVsbCAwXQovTGFuZyhlbi1JTikKPj4KZW5kb2JqCgoxMyAwIG9iago8PC9DcmVhdG9yPEZFRkYwMDU3MDA3MjAwNjkwMDc0MDA2NTAwNzI+Ci9Qcm9kdWNlcjxGRUZGMDA0QzAwNjkwMDYyMDA3MjAwNjUwMDRGMDA2NjAwNjYwMDY5MDA2MzAwNjUwMDIwMDAzNzAwMkUwMDMzPgovQ3JlYXRpb25EYXRlKEQ6MjAyMzA5MjkxMjU0NTMrMDUnMzAnKT4+CmVuZG9iagoKeHJlZgowIDE0CjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwNTY1OSAwMDAwMCBuIAowMDAwMDAwMDE5IDAwMDAwIG4gCjAwMDAwMDAxOTIgMDAwMDAgbiAKMDAwMDAwNTgyOCAwMDAwMCBuIAowMDAwMDAwMjEyIDAwMDAwIG4gCjAwMDAwMDQ4NjkgMDAwMDAgbiAKMDAwMDAwNDg5MCAwMDAwMCBuIAowMDAwMDA1MDkwIDAwMDAwIG4gCjAwMDAwMDUzOTQgMDAwMDAgbiAKMDAwMDAwNTU3MiAwMDAwMCBuIAowMDAwMDA1NjA0IDAwMDAwIG4gCjAwMDAwMDU5NTMgMDAwMDAgbiAKMDAwMDAwNjA1MCAwMDAwMCBuIAp0cmFpbGVyCjw8L1NpemUgMTQvUm9vdCAxMiAwIFIKL0luZm8gMTMgMCBSCi9JRCBbIDw2NUI1MkQzQURGMzA3QzIxNUZGMzc0NUIxN0FBQjMwRT4KPDY1QjUyRDNBREYzMDdDMjE1RkYzNzQ1QjE3QUFCMzBFPiBdCi9Eb2NDaGVja3N1bSAvMzVGMzI0ODdCN0U3MTg3REVGMEI0MDdFRUY1MEZFQTEKPj4Kc3RhcnR4cmVmCjYyMjUKJSVFT0YK';
  doc1.name = 'Lorem Ipsum'; // can be different from actual file name
  doc1.fileExtension = 'pdf';
  doc1.documentId = '3';

  // The order in the docs array determines the order in the envelope
  env.documents = [doc1];

  // Create a signer recipient to sign the document, identified by name and email
  // We set the clientUserId to enable embedded signing for the recipient
  // We're setting the parameters via the object creation
  let signer1 = docusign.Signer.constructFromObject({
    email: 'prasanth.v@deltasoft.in',
    name: 'Prasanth V',
    clientUserId: '1bb4140e-d491-4b75-ac2a-6a427175c240',
    recipientId: 1,
  });

  // Create signHere fields (also known as tabs) on the documents,
  // We're using anchor (autoPlace) positioning
  //
  // The DocuSign platform seaches throughout your envelope's
  // documents for matching anchor strings.
  let signHere1 = docusign.SignHere.constructFromObject({
    anchorString: '/sn1/',
    anchorYOffset: '10',
    anchorUnits: 'pixels',
    anchorXOffset: '20',
  });
  // Tabs are set per recipient / signer
  let signer1Tabs = docusign.Tabs.constructFromObject({
    signHereTabs: [signHere1],
  });
  signer1.tabs = signer1Tabs;

  // Add the recipient to the envelope object
  let recipients = docusign.Recipients.constructFromObject({
    signers: [signer1],
  });
  env.recipients = recipients;

  // Request that the envelope be sent by setting |status| to "sent".
  // To request that the envelope be created as a draft, set to "created"
  env.status = 'sent';

  return env;
};
exports.makeEnvelope = makeEnvelope;
